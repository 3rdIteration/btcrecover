# *seedrecover.py* #

*seedrecover.py* is a seed recovery tool which can take a seed with one or more mistakes in it, and recover the correct seed if not too many mistakes have been made.

* Seed/Passphrase Recovery when you have a known address you have used for:
    * Bitcoin
    * Bitcoin Cash
    * Ethereum
    * Litecoin
    * Dash
    * Dogecoin
    * Vertcoin
    * Monacoin
    * And many other 'Bitcoin Like' cryptos
 * Seed/Passphrase recovery via Address DB (Where you don't need to know an address to search for) supporting:
    * Bitcoin
    * Bitcoin Cash
    * Litecoin
    * Vertcoin
    * Monacoin
    * Likely many other 'Bitcoin like' cryptos

## Installation ##

Just download the latest version from <https://github.com/3rdIteration/btcrecover/archive/master.zip> and unzip it to a location of your choice.

Additional requirements are described below.

### Windows ###

 1. Follow [these instructions](INSTALL.md#python-27) to download and install Python 2.7.

 2. Open a command prompt window, and type this to install the required Python libraries:

        C:\Python27\Scripts\pip install coincurve==5.2.0 pysha3

### Linux ###

Most distributions include Python 2.7 pre-installed. Two additional Python libraries, coincurve and (for Ethereum wallets) pysha3 are required. For example on Debian-like distributions (including Ubuntu), open a terminal window and type this:

    sudo apt-get install python-pip
    sudo pip install coincurve==5.2.0 pysha3

### OS X ###

 1. Follow [these instructions](INSTALL.md#os-x) to download and install the latest version of Python 2.7.

 2. Open a terminal window (open the Launchpad and search for "terminal"). Type this and then choose `Install` to install the command line developer tools:

        xcode-select --install

 3. Type this to install the GNU Multiple Precision Arithmetic Library: 
 
        curl -O https://gmplib.org/download/gmp/gmp-6.1.2.tar.xz
        tar xf gmp-6.1.2.tar.xz
        cd gmp-6.1.2
        ./configure --prefix=/usr/local/opt/gmp
        make && make check
        sudo make install
        cd ..
        rm -rf gmp-6.1.2 gmp-6.1.2.tar.xz

 4. Type this to install coincurve and (for Ethereum wallets) pysha3:

        sudo pip install coincurve==5.2.0 pysha3


## Running *seedrecover.py* ##

In order to run *seedrecover.py*, you'll need these two things:

 * A good estimate of what your seed is, *and*

 * *One* of these four, in order of preference:
     1. for Electrum (1.x or 2.x), a copy of your wallet file (a wallet file using Electrum 2.8's new full-file encryption won't work here), *or*
     2. your master public key (sometimes called an *xpub*), *or*
     3. a receiving address that was generated by your wallet from your seed, along with a good estimate of how many addresses you created before the receiving address you'd like to use, *or*
     4. an "address database". If you don't have i., ii., or iii. from above, please see the [Recovery with an Address Database](#recovery-with-an-address-database) section below.

To start *seedrecover.py* on OS X, first rename the `seedrecover.py` script file to `seedrecover.command`. Aside from this, starting it is the same for every system: just double-click the `seedrecover.py` (or `seedrecover.command`) file. If you're asked about running it in a terminal, choose *Run in Terminal*. Next, you'll be asked a short series of questions:

 1. First you'll be asked to open your wallet file. If you have an Electrum wallet file, find it now - the rest of the steps will then be skipped. Otherwise, click `Cancel` to continue.

 2. Next, select your wallet type. If you're unsure of what to choose, feel free to open an [issue on GitHub](https://github.com/3rdIteration/btcrecover/issues/new) to see if your wallet software is supported. 

 3. Next you'll be asked for your master public key. If you don't have yours stored anywhere, click `Cancel` to continue.

 4. If you don't have your master public key, next you'll be asked for your Bitcoin addresses. Find as many of your addresses associated with this wallet as you can, and enter them here (separated by spaces). Addresses you created early in your wallet's lifetime are prefereable. If your wallet supports multiple "accounts" each with their own address list, only addresses from your first account should be entered here.

 5. If you entered addresses above, next you'll be asked to enter the "address generation limit". *seedrecover.py* works by generating one or more addresses based on each seed it tries. The generation limit is the number of addresses it generates for each seed. Generating fewer addresses will improve *seedrecover.py*'s speed, however if it generates too few, it will miss the correct seed entirely.
 
    For example, let's say you found and entered three addresses in step 4. If you're reasonably sure that all three were within the first 10 addresses ever created in your wallet, you should use `10` for the address generation limit.

Finally, you'll be asked for your best guess of what your seed is.

### Recovery with an Address Database ###

When *seedrecover.py* tries different guesses based on the seed you entered, it needs a way to determine which seed guess is correct. Normally it uses each seed guess to create a master public key (an *mpk*) and compare it to the mpk you entered, or to create Bitcoin addresses and compare them to the addresses you entered. If you have neither your mpk nor any of your addresses, it's still possible to use *seedrecover.py* but it is more complicated and time consuming. **The main time cost in this process is in downloading the blockchain and generating the AddressDB, the actual "seedrecover" part of the process runs at about the same speed regardless of whether it is being tested against a single address or an addressDB witl 600,000 addresses in it...**

This works by generating addresses, just as above, and then looking for each generated address in the entire blockchain. In order to do this, you must first create a database of addresses based on the blockchain.

This method of recovery supports checking against the following blockchains:
* Bitcoin
* Bitcoin Cash
* Litecoin
* Vertcoin
* Monacoin

It may also work with other 'bitcoin like' blockchains via attempting to foce it via the --dbyolo flag

I have created and uploaded AddressDatabases for the supported chains and will update them periodically.

**[You can download them from Mega here...](https://mega.nz/#F!k4E1BahC!iPYiM7D7ZVsjhcFdohDosA)** (You can then unzip them and use the --addressdb to include the full path and filename to tell seedrecover.py where to look)

It is possible to create an address database that includes only addresses for transactions that happened between specific dates. This can be useful in that it requires less additional space for the AddressDB file and also uses significantly less ram. (Eg: You may select to only consider addresses that were used after you ordered your hardware wallet) This is done via the --blocks-startdate BLOCKS_STARTDATE and --blocks-enddate BLOCKS_ENDDATE arguments, with the date in the format of YYYY-MM-DD

It is also possible to tell the AddressDB creation script to start processing at a certain blockfile. This is helpful to speed up the processing of larger blockchains. (Eg: If you only wanted the addresses used in 2018 for Bitcoin) This is done via --first-block-file FIRST_BLOCK_FILE, with FIRST_BLOCK_FILE being the number of the block file. **This feature won't warn you if you tell it to start counting blocks AFTER the start-date if used with --blocks-startdate**

**A note concerning DB Length Parameter**
This tool creates a database file where you need to specify its maximum size beforehand. This maximum number of addresses is given as a power of 2, eg: --dblength 30 makes space about for 2^30 addresses, just under a billion... Basically, if there are more addresses in the blockchain than room in the file, the program will just crash, so you may need to re-run it and increase --dblength by one. It defaults to 30, which creates an ~8GB file and is enough for the Bitcoin Blockchain in Nov 2018. (I plan to change this behavior so that by default it will start small and retry a few times as required after the Python3 move) **The thing is that the AddressDB file size depends on the max number of addresses it can accomodate, not how many are used.** What this means is that if you are generating an addressDB for a smaller blockchain like Vertcoin, you can get away with specifying a smaller dblength to save space. If you leave it as the defaults, you will end up with an 8GB file when a ~30mb file would have worked. **Though if you have plenty of HDD space, then it doesn't matter** 

A rought guide of the size and parameters as at Nov 2019 is:

| Coin         | Blockchain Size | AddressDB Size  | Required DBLength |
| -------------|:---------------:| ---------------:|------------------:|
| Bitcoin      | 265 GB          | 8 GB            | 30                |
| Bitcoin Cash | 155 GB          | 4 GB            | 29                |
| Litecoin     | 26GB            | 500 MB          | 26                |
| Vertcoin     | 5 GB            | 32 MB           | 22                |
| Monacoin     | 2.5 GB          | 32 MB           | 22                |

**Altcoin Blockchains**
This tool is tested to work with the blockchains specified above. By default, it will scan the default Bitcoin install directory and use that. If you have installed Bitcoin somewhere else, or you want to create an AddressDB from an alternative blockchain, you will need to manually specifiy its location with the --datadir argument.

The question of which blockchain you want to use comes down to your personal situation. That said, if you have a BIP39 wallet that you know you used to store Litecoin or Vertcoin at some point, then you may prefer to start by downloading and using one of these chains rather than downloading the full BTC blockchain. Your BIP39/44 wallet will use the same seed for all currencies, so it doesn't matter which one you use to recover your seed. 

**Exmaples to Reproduce**
If you want to run some tests against an AddressDB, there are for test DBs that are in the [./btcrecover/test](https://github.com/3rdIteration/btcrecover/tree/p2wpkh-p2sh/btcrecover/test) folder of this project. Basically they are small because they only contain 24hr hours worth of addresses from each block. (They were created with the --blocks-startdate and enddate arguments) 

You can run a test using one of these databases with the command:

   python seedrecover.py --no-dupchecks --addr-limit 2 --bip32-path "m/44'/28'/1'/0" --big-typos 1 --addressdb ./btcrecover/test/addresses-VTC-Test.db

And the seed with the number 1 instead of the first word...
   1 entire sniff tired miracle solve shadow scatter hello never tank side sight isolate sister uniform advice pen praise soap lizard festival connect baby

You can find more examples of tests that use the small AddressDBs in the unit tests covered in [test_seeds.py](https://github.com/3rdIteration/btcrecover/blob/p2wpkh-p2sh/btcrecover/test/test_seeds.py) , just search for the methods starting with "test_addressdb_" and the parameters will list the addressDB limit, test phrase, derivation path and AddressDB used.

**Steps to Create an AddressDb from the Blockchain Data:**
 1. You must use a computer with enough space for the full blockchain that you want to process and RAM equal to double the AddressDB size that you will end up with (This is an extremely generous estimate, you will likely be fine with less, but pretty much need to have at least as much as the AddressDB you want to create) . You must have the 64-bit version of Python installed. (Other smaller blockchains require significantly less space and RAM)

 2. Install a full-node client for your blockchain of choice, such as [Bitcoin Unlimited](https://www.bitcoinunlimited.info/), [Bitcoin Classic](https://bitcoinclassic.com/), [Bitcoin XT](https://bitcoinxt.software/), or [Bitcoin Core](https://bitcoincore.org/).

 3. Start your full-node client and allow it to fully sync. Depending on your Internet connection and your computer, fully syncing a node can take one or more days. Starting `bitcoin-qt` (or `bitcoind`) with the `-dbcache #` option can help: the `#` is the amount of RAM, in MB, to use for the database cache. If your computer has at least 8 GB of RAM, giving up to `4000` MB to the `-dbcache` will speed things up. Installing Bitcoin on a computer with an SSD can also help.

 4. Once your full-node client is synced, close the full-node client software.

 5. (On OS X, rename the `create-address-db.py` script file to `create-address-db.command`.) Double-click on the `create-address-db.py` script (in the same folder as `seedrecover.py`) to build the address database using the fully-synced blockchain (it will be saved into the same directory as `create-address-db.py` with the name `addresses.db`) . This process will take about one hour, and use about 4 GB of both RAM and drive space.

 6. Follow the steps listed in the [Running *seedrecover.py*](#running-seedrecoverpy) section, except that when you get to the address entry window in step 4, click `Cancel`.

 7. For the next step, you still need to choose an address generation limit. This should be the number of unused addresses you suspect you have at the beginning of your wallet before the first one you ever used. If you're sure you used the very first address in your wallet, you can use `1` here, but if you're not so sure, you should choose a higher estimate (although it may take longer for *seedrecover.py* to run).

Note that *seedrecover.py* will use about the same amount of RAM as the size of the AddressDB file while it is running with an address database. (Eg: Full Bitcoin AddressDB will require about 8.5gb of RAM as of Nov 2019)
